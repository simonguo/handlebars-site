<!DOCTYPE html>
<html>
  <head>
    <title>Handlebars.js 中文网: Minimal Templating on Steroids</title>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
    <link href="/stylesheets/application.css" media="all" rel="stylesheet" type="text/css"/><link href="/stylesheets/sunburst.css" media="all" rel="stylesheet" type="text/css"/>
    <link href="/images/favicon.png" rel="shortcut icon" type="image/png">
  </head>
  <body>
    <div id="body">
      <div id="header">
        <a href="/">
          <img alt="Handlebars.js 中文网: Minimal Templating on Steroids" src="images/handlebars_logo.png"/>
        </a>
      </div>
      <div id="contents">
        <a href="http://www.devswag.com/collections/handlebars" id="callout">
          <img alt="上DevSwag购买Handlebars商品!" src="images/handlebars-devswag.png"/>
        </a>
        <div id="intro">
          <p>
            块级 helpers 使用自定义的迭代器，其他的 helpers 都可以使用一个新的上下文来执行内部的代码块。
          </p>
        </div>
        <h2 id="basic-blocks">
          基础
        </h2>
        <div class="contents">
          <div class="bullet">
            <div class="description">
              先定义一个简单的块级 helper，它只是简单的执行一下这块代码，就跟没有用这个helper一样。
            </div>
            <pre class="sunburst"><span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">div</span> <span class="MetaTagAll">class</span>=<span class="String"><span class="String">&quot;</span>entry<span class="String">&quot;</span></span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span><span class="EmbeddedSourceBright">{{title}}</span><span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">div</span> <span class="MetaTagAll">class</span>=<span class="String"><span class="String">&quot;</span>body<span class="String">&quot;</span></span><span class="MetaTagAll">&gt;</span></span>&#x000A;    <span class="EmbeddedSourceBright">{{#noop}}</span><span class="EmbeddedSourceBright">{{body}}</span><span class="EmbeddedSourceBright">{{/noop}}</span>&#x000A;  <span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>&#x000A;<span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>&#x000A;</pre>
            <div class="notes">
              这个 <code>noop</code>  helper 接受一个 options 对象。
              这个对象有一个叫 (<code>options.fn</code>) 的方法，
              这个方法的用法就跟普通的编译过的 Hanldebars 模板的用法一样。
              所不同的就是，这个函数执行时会带有一个上下文，
              并且会返回一个字符串。
            </div>
            <pre class="sunburst">Handlebars.registerHelper(<span class="String"><span class="String">&#39;</span>noop<span class="String">&#39;</span></span>, <span class="Storage">function</span>(options) {&#x000A;  <span class="Keyword">return</span> options.fn(<span class="Variable">this</span>);&#x000A;});&#x000A;</pre>
            <div class="notes">
              Handlebars 在执行 helpers 的时候，总是会将
              <code>this</code> 指向当前的上下文，所以，你只需用
              <code>this</code> 来调用这一块代码，就可以在当前的上下文中求值了。
            </div>
            <div class="notes">
              Any helpers defined in this manner will take precedence over fields defined in the context.
              To access a field that is masked by a helper, a path reference may be used.
              In the example above a field named <code>noop</code> on the context object
              would be referenced using:
            </div>
            <pre class="sunburst"><span class="EmbeddedSourceBright">{{./noop}}</span>&#x000A;</pre>
          </div>
        </div>
        <h2 id="basic-blocks">
          Basic Block Variation
        </h2>
        <div class="contents">
          <div class="bullet">
            <div class="description">
              To better illustrate the syntax, let's define another block helper that adds some markup to the wrapped text.
            </div>
            <pre class="sunburst"><span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">div</span> <span class="MetaTagAll">class</span>=<span class="String"><span class="String">&quot;</span>entry<span class="String">&quot;</span></span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span><span class="EmbeddedSourceBright">{{title}}</span><span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">div</span> <span class="MetaTagAll">class</span>=<span class="String"><span class="String">&quot;</span>body<span class="String">&quot;</span></span><span class="MetaTagAll">&gt;</span></span>&#x000A;    <span class="EmbeddedSourceBright">{{#bold}}</span><span class="EmbeddedSourceBright">{{body}}</span><span class="EmbeddedSourceBright">{{/bold}}</span>&#x000A;  <span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>&#x000A;<span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>&#x000A;</pre>
            <div class="notes">
              The <code>bold</code> helper will add markup to make its text bold.
              As before, the function will take a context as input and return a String.
            </div>
            <pre class="sunburst">Handlebars.registerHelper(<span class="String"><span class="String">&#39;</span>bold<span class="String">&#39;</span></span>, <span class="Storage">function</span>(options) {&#x000A;  <span class="Keyword">return</span> <span class="Keyword">new</span> <span class="JEntityNameType">Handlebars.SafeString</span>(&#x000A;      <span class="String"><span class="String">&#39;</span>&lt;div class=&quot;mybold&quot;&gt;<span class="String">&#39;</span></span>&#x000A;      <span class="Keyword">+</span> options.fn(<span class="Variable">this</span>)&#x000A;      <span class="Keyword">+</span> <span class="String"><span class="String">&#39;</span>&lt;/div&gt;<span class="String">&#39;</span></span>);&#x000A;});&#x000A;</pre>
          </div>
        </div>
        <h2 id="with-helper">
          <code>with</code> helper
        </h2>
        <div class="contents">
          <div class="bullet">
            <div class="description">
              在上面介绍的 <code>noop</code> helper 的基础上，很容易的就能想到应该如何实现
              <code>with</code> helper 了。这里呢，
              不是用当前的上下文来执行代码块，我们可以使用任意的模板所传递进来的上下文。
            </div>
            <pre class="sunburst"><span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">div</span> <span class="MetaTagAll">class</span>=<span class="String"><span class="String">&quot;</span>entry<span class="String">&quot;</span></span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span><span class="EmbeddedSourceBright">{{title}}</span><span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="EmbeddedSourceBright">{{#with story}}</span>&#x000A;    <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">div</span> <span class="MetaTagAll">class</span>=<span class="String"><span class="String">&quot;</span>intro<span class="String">&quot;</span></span><span class="MetaTagAll">&gt;</span></span><span class="EmbeddedSourceBright">{{{intro}}</span>}<span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>&#x000A;    <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">div</span> <span class="MetaTagAll">class</span>=<span class="String"><span class="String">&quot;</span>body<span class="String">&quot;</span></span><span class="MetaTagAll">&gt;</span></span><span class="EmbeddedSourceBright">{{{body}}</span>}<span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="EmbeddedSourceBright">{{/with}}</span>&#x000A;<span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>&#x000A;</pre>
            <div class="notes">
              在你使用的JSON嵌套非常深的时候，就会觉得这个helper 非常有帮助了，
              否则的话，每次都需要先写上很长的父级属性。比如上面的模板可以使用下面的这段JSON：
            </div>
            <pre class="sunburst">{&#x000A;  title: <span class="String"><span class="String">&quot;</span>First Post<span class="String">&quot;</span></span>,&#x000A;  story: {&#x000A;    intro: <span class="String"><span class="String">&quot;</span>Before the jump<span class="String">&quot;</span></span>,&#x000A;    body: <span class="String"><span class="String">&quot;</span>After the jump<span class="String">&quot;</span></span>&#x000A;  }&#x000A;}&#x000A;</pre>
            <div class="notes">
              实现这种helper，就跟实现一堆 <code>noop</code> helper 没什么区别。要注意的是，
              helpers 可以接受参数，并且对参数的求值就跟直接使用 <code>{{mustache}}</code>
              表达式一样一样地。
            </div>
            <pre class="sunburst">Handlebars.registerHelper(<span class="String"><span class="String">&#39;</span>with<span class="String">&#39;</span></span>, <span class="Storage">function</span>(context, options) {&#x000A;  <span class="Keyword">return</span> options.fn(context);&#x000A;});&#x000A;</pre>
            <div class="notes">
              helpers 接受参数的顺序跟传递进来的顺序相同。
            </div>
          </div>
        </div>
        <h2 id="iterators">
          简单的迭代器
        </h2>
        <div class="contents">
          <div class="bullet">
            <div class="description">
              使用块级 helpers 的一个非常常见的目的就是定义一个自定义的迭代器。
              实际上，所有的 Handlebars 内置的 helpers 就是一些常规的 块级 helpers。
              我们一起来看看内置的 each helper 是如何工作的：
            </div>
            <pre class="sunburst"><span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">div</span> <span class="MetaTagAll">class</span>=<span class="String"><span class="String">&quot;</span>entry<span class="String">&quot;</span></span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span><span class="EmbeddedSourceBright">{{title}}</span><span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="EmbeddedSourceBright">{{#with story}}</span>&#x000A;    <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">div</span> <span class="MetaTagAll">class</span>=<span class="String"><span class="String">&quot;</span>intro<span class="String">&quot;</span></span><span class="MetaTagAll">&gt;</span></span><span class="EmbeddedSourceBright">{{{intro}}</span>}<span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>&#x000A;    <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">div</span> <span class="MetaTagAll">class</span>=<span class="String"><span class="String">&quot;</span>body<span class="String">&quot;</span></span><span class="MetaTagAll">&gt;</span></span><span class="EmbeddedSourceBright">{{{body}}</span>}<span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="EmbeddedSourceBright">{{/with}}</span>&#x000A;<span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>&#x000A;<span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">div</span> <span class="MetaTagAll">class</span>=<span class="String"><span class="String">&quot;</span>comments<span class="String">&quot;</span></span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="EmbeddedSourceBright">{{#each comments}}</span>&#x000A;    <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">div</span> <span class="MetaTagAll">class</span>=<span class="String"><span class="String">&quot;</span>comment<span class="String">&quot;</span></span><span class="MetaTagAll">&gt;</span></span>&#x000A;      <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">h2</span><span class="MetaTagAll">&gt;</span></span><span class="EmbeddedSourceBright">{{subject}}</span><span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">h2</span><span class="MetaTagAll">&gt;</span></span>&#x000A;      <span class="EmbeddedSourceBright">{{{body}}</span>}&#x000A;    <span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="EmbeddedSourceBright">{{/each}}</span>&#x000A;<span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>&#x000A;</pre>
            <div class="notes">
              在这里的情况下，我们希望对 comments 数组的每一项都执行 传递给 each 的这一块代码。
            </div>
            <pre class="sunburst">Handlebars.registerHelper(<span class="String"><span class="String">&#39;</span>each<span class="String">&#39;</span></span>, <span class="Storage">function</span>(context, options) {&#x000A;  <span class="Storage">var</span> ret <span class="Keyword">=</span> <span class="String"><span class="String">&quot;</span><span class="String">&quot;</span></span>;&#x000A;&#x000A;  <span class="Keyword">for</span>(<span class="Storage">var</span> i<span class="Keyword">=</span><span class="Constant">0</span>, j<span class="Keyword">=</span>context.<span class="SupportConstant">length</span>; i<span class="Keyword">&lt;</span>j; i<span class="Keyword">++</span>) {&#x000A;    ret <span class="Keyword">=</span> ret <span class="Keyword">+</span> options.fn(context[i]);&#x000A;  }&#x000A;&#x000A;  <span class="Keyword">return</span> ret;&#x000A;});&#x000A;</pre>
            <div class="notes">
              这样，我们迭代传进来的参数的每一个项，并在每一次迭代的时候执行一次块中的代码。
              在我们迭代的过程中，还构建了一个字符串，并最终返回这个字符串。
            </div>
          </div>
          <div class="bullet">
            <div class="description">
              可以看出，你也可以很容易的实现一个更高级的迭代器。
              例如，我们创建一个迭代器，可以生成 <code>&lt;ul&gt;</code> 的包裹容器，
              并且把每一个元素的计算结果包裹到<code>&lt;li&gt;</code> 中去。
            </div>
            <pre class="sunburst"><span class="EmbeddedSourceBright">{{#list nav}}</span>&#x000A;  <span class="MetaTagInline"><span class="MetaTagInline">&lt;</span><span class="MetaTagInline">a</span> <span class="MetaTagInline">href</span>=<span class="String"><span class="String">&quot;</span><span class="StringEmbeddedSource">{{url}}</span><span class="String">&quot;</span></span><span class="MetaTagInline">&gt;</span></span><span class="EmbeddedSourceBright">{{title}}</span><span class="MetaTagInline"><span class="MetaTagInline">&lt;/</span><span class="MetaTagInline">a</span><span class="MetaTagInline">&gt;</span></span>&#x000A;<span class="EmbeddedSourceBright">{{/list}}</span>&#x000A;</pre>
            <div class="notes">
              可以使用类似下面的上下文来执行模板：
            </div>
            <pre class="sunburst">{&#x000A;  nav: [&#x000A;    { url: <span class="String"><span class="String">&quot;</span>http://www.yehudakatz.com<span class="String">&quot;</span></span>, title: <span class="String"><span class="String">&quot;</span>Katz Got Your Tongue<span class="String">&quot;</span></span> },&#x000A;    { url: <span class="String"><span class="String">&quot;</span>http://www.sproutcore.com/block<span class="String">&quot;</span></span>, title: <span class="String"><span class="String">&quot;</span>SproutCore Blog<span class="String">&quot;</span></span> },&#x000A;  ]&#x000A;}&#x000A;</pre>
            <div class="notes">
              这个 helper 跟内置的 <code>each</code> helper 没有太大的不同。
            </div>
            <pre class="sunburst">Handlebars.registerHelper(<span class="String"><span class="String">&#39;</span>list<span class="String">&#39;</span></span>, <span class="Storage">function</span>(context, options) {&#x000A;  <span class="Storage">var</span> ret <span class="Keyword">=</span> <span class="String"><span class="String">&quot;</span>&lt;ul&gt;<span class="String">&quot;</span></span>;&#x000A;&#x000A;  <span class="Keyword">for</span>(<span class="Storage">var</span> i<span class="Keyword">=</span><span class="Constant">0</span>, j<span class="Keyword">=</span>context.<span class="SupportConstant">length</span>; i<span class="Keyword">&lt;</span>j; i<span class="Keyword">++</span>) {&#x000A;    ret <span class="Keyword">=</span> ret <span class="Keyword">+</span> <span class="String"><span class="String">&quot;</span>&lt;li&gt;<span class="String">&quot;</span></span> <span class="Keyword">+</span> options.fn(context[i]) <span class="Keyword">+</span> <span class="String"><span class="String">&quot;</span>&lt;/li&gt;<span class="String">&quot;</span></span>;&#x000A;  }&#x000A;&#x000A;  <span class="Keyword">return</span> ret <span class="Keyword">+</span> <span class="String"><span class="String">&quot;</span>&lt;/ul&gt;<span class="String">&quot;</span></span>;&#x000A;});&#x000A;</pre>
            <div class="notes">
              你当然也可以使用类似 underscore.js 或 SproutCore's 的类库，让代码看起来更精简漂亮些。
              使用 SproutCore's 的示例如下：
            </div>
            <pre class="sunburst">Handlebars.registerHelper(<span class="String"><span class="String">&#39;</span>list<span class="String">&#39;</span></span>, <span class="Storage">function</span>(context, options) {&#x000A;  <span class="Keyword">return</span> <span class="String"><span class="String">&quot;</span>&lt;ul&gt;<span class="String">&quot;</span></span> <span class="Keyword">+</span> context.map(<span class="Storage">function</span>(item) {&#x000A;    <span class="Keyword">return</span> <span class="String"><span class="String">&quot;</span>&lt;li&gt;<span class="String">&quot;</span></span> <span class="Keyword">+</span> options.fn(item) <span class="Keyword">+</span> <span class="String"><span class="String">&quot;</span>&lt;/li&gt;<span class="String">&quot;</span></span>;&#x000A;  }).<span class="SupportFunction">join</span>(<span class="String"><span class="String">&quot;</span><span class="StringConstant">\n</span><span class="String">&quot;</span></span>) <span class="Keyword">+</span> <span class="String"><span class="String">&quot;</span>&lt;/ul&gt;<span class="String">&quot;</span></span>;&#x000A;});&#x000A;</pre>
          </div>
        </div>
        <h2 id="conditionals">
          条件
        </h2>
        <div class="contents">
          <div class="bullet">
            <div class="description">
              使用 helpers 的另一个常见需求就是实现条件判断。
              再次重申一遍，Handlebars 内置的 <code>if</code> 和 <code>unless</code> 控制结构就是使用常规的 helpers 来实现的。
            </div>
            <pre class="sunburst"><span class="EmbeddedSourceBright">{{#if isActive}}</span>&#x000A;  <span class="MetaTagInline"><span class="MetaTagInline">&lt;</span><span class="MetaTagInline">img</span> <span class="MetaTagInline">src</span>=<span class="String"><span class="String">&quot;</span>star.gif<span class="String">&quot;</span></span> <span class="MetaTagInline">alt</span>=<span class="String"><span class="String">&quot;</span>Active<span class="String">&quot;</span></span><span class="MetaTagInline">&gt;</span></span>&#x000A;<span class="EmbeddedSourceBright">{{/if}}</span>&#x000A;</pre>
            <div class="notes">
              控制结构一般不会改变上下文，只是要根据一些变量来决定是否要执行这一块代码。
            </div>
            <pre class="sunburst">Handlebars.registerHelper(<span class="String"><span class="String">&#39;</span>if<span class="String">&#39;</span></span>, <span class="Storage">function</span>(conditional, options) {&#x000A;  <span class="Keyword">if</span>(conditional) {&#x000A;    <span class="Keyword">return</span> options.fn(<span class="Variable">this</span>);&#x000A;  }&#x000A;});&#x000A;</pre>
          </div>
          <div class="bullet">
            <div class="description">
              在写控制结构的时候，经常需要在模板中提供一块 条件求值返回false时 执行的模板代码。
              Handlebars 给 helpers 提供了通用的 <code>else</code> 功能来解决这个问题。
            </div>
            <pre class="sunburst"><span class="EmbeddedSourceBright">{{#if isActive}}</span>&#x000A;  <span class="MetaTagInline"><span class="MetaTagInline">&lt;</span><span class="MetaTagInline">img</span> <span class="MetaTagInline">src</span>=<span class="String"><span class="String">&quot;</span>star.gif<span class="String">&quot;</span></span> <span class="MetaTagInline">alt</span>=<span class="String"><span class="String">&quot;</span>Active<span class="String">&quot;</span></span><span class="MetaTagInline">&gt;</span></span>&#x000A;<span class="EmbeddedSourceBright">{{else}}</span>&#x000A;  <span class="MetaTagInline"><span class="MetaTagInline">&lt;</span><span class="MetaTagInline">img</span> <span class="MetaTagInline">src</span>=<span class="String"><span class="String">&quot;</span>cry.gif<span class="String">&quot;</span></span> <span class="MetaTagInline">alt</span>=<span class="String"><span class="String">&quot;</span>Inactive<span class="String">&quot;</span></span><span class="MetaTagInline">&gt;</span></span>&#x000A;<span class="EmbeddedSourceBright">{{/if}}</span>&#x000A;</pre>
            <div class="notes">
              Handlebars 以 <code>options.inverse</code> 的形式来支持 <code>else</code> 块中的代码。如果模板没有提供条件取反的模板，
              Handlebars会自动的创建一个 空函数，这样你就不必去检查 inverse 是否存在了。
            </div>
            <pre class="sunburst">Handlebars.registerHelper(<span class="String"><span class="String">&#39;</span>if<span class="String">&#39;</span></span>, <span class="Storage">function</span>(conditional, options) {&#x000A;  <span class="Keyword">if</span>(conditional) {&#x000A;    <span class="Keyword">return</span> options.fn(<span class="Variable">this</span>);&#x000A;  } <span class="Keyword">else</span> {&#x000A;    <span class="Keyword">return</span> options.inverse(<span class="Variable">this</span>);&#x000A;  }&#x000A;});&#x000A;</pre>
            <div class="notes">
              Handlebars 还给 helpers 提供了额外的元数据，附加在 options 对象上面。继续阅读下面的例子。
            </div>
          </div>
          <div class="bullet">
            <div class="description">
              Conditionals may also be chained by including the subsequent helper call
              within the else mustache.
            </div>
            <pre class="sunburst"><span class="EmbeddedSourceBright">{{#if isActive}}</span>&#x000A;  <span class="MetaTagInline"><span class="MetaTagInline">&lt;</span><span class="MetaTagInline">img</span> <span class="MetaTagInline">src</span>=<span class="String"><span class="String">&quot;</span>star.gif<span class="String">&quot;</span></span> <span class="MetaTagInline">alt</span>=<span class="String"><span class="String">&quot;</span>Active<span class="String">&quot;</span></span><span class="MetaTagInline">&gt;</span></span>&#x000A;<span class="EmbeddedSourceBright">{{else if isInactive}}</span>&#x000A;  <span class="MetaTagInline"><span class="MetaTagInline">&lt;</span><span class="MetaTagInline">img</span> <span class="MetaTagInline">src</span>=<span class="String"><span class="String">&quot;</span>cry.gif<span class="String">&quot;</span></span> <span class="MetaTagInline">alt</span>=<span class="String"><span class="String">&quot;</span>Inactive<span class="String">&quot;</span></span><span class="MetaTagInline">&gt;</span></span>&#x000A;<span class="EmbeddedSourceBright">{{/if}}</span>&#x000A;</pre>
            <div class="notes">
              It is not necessary to use the same helper in subsequent calls, the
              <code>unless</code> helper could be used in the else portion as with any
              other helper. When the helper values are different, the closing mustache
              should match the opening helper name.
            </div>
          </div>
        </div>
        <h2 id="hash-arguments">
          哈希参数
        </h2>
        <div class="contents">
          <div class="bullet">
            <div class="description">
              就像普通的 helpers，块级 helpers 可以接受一个可选的对象作为最后一个参数。
              我们一起重温一下 <code>list</code> helper，并让他可以接受任意数量的可选属性，并且把添加到我们要创建的
              <code>&lt;ul&gt;</code> 元素上。
            </div>
            <pre class="sunburst"><span class="EmbeddedSourceBright">{{#list nav id=&quot;nav-bar&quot; class=&quot;top&quot;}}</span>&#x000A;  <span class="MetaTagInline"><span class="MetaTagInline">&lt;</span><span class="MetaTagInline">a</span> <span class="MetaTagInline">href</span>=<span class="String"><span class="String">&quot;</span><span class="StringEmbeddedSource">{{url}}</span><span class="String">&quot;</span></span><span class="MetaTagInline">&gt;</span></span><span class="EmbeddedSourceBright">{{title}}</span><span class="MetaTagInline"><span class="MetaTagInline">&lt;/</span><span class="MetaTagInline">a</span><span class="MetaTagInline">&gt;</span></span>&#x000A;<span class="EmbeddedSourceBright">{{/list}}</span>&#x000A;</pre>
            <div class="notes">
              Handlebars 以 <code>options.hash</code> 的形式把最后传进来的键值对挂在上来。
              这样就更容易接受不定数量的参数了，同时接受一个可选的对象。
              如果模板没有提供哈希参数，Handlebars 会自动的传一个空对象（<code>{}</code>），
              这样你就不必检查哈希参数是否存在了。
            </div>
            <pre class="sunburst">Handlebars.registerHelper(<span class="String"><span class="String">&#39;</span>list<span class="String">&#39;</span></span>, <span class="Storage">function</span>(context, options) {&#x000A;  <span class="Storage">var</span> attrs <span class="Keyword">=</span> Em.keys(options.<span class="SupportConstant">hash</span>).map(<span class="Storage">function</span>(key) {&#x000A;    <span class="Keyword">return</span> key <span class="Keyword">+</span> <span class="String"><span class="String">&#39;</span>=&quot;<span class="String">&#39;</span></span> <span class="Keyword">+</span> options.<span class="SupportConstant">hash</span>[key] <span class="Keyword">+</span> <span class="String"><span class="String">&#39;</span>&quot;<span class="String">&#39;</span></span>;&#x000A;  }).<span class="SupportFunction">join</span>(<span class="String"><span class="String">&quot;</span> <span class="String">&quot;</span></span>);&#x000A;&#x000A;  <span class="Keyword">return</span> <span class="String"><span class="String">&quot;</span>&lt;ul <span class="String">&quot;</span></span> <span class="Keyword">+</span> attrs <span class="Keyword">+</span> <span class="String"><span class="String">&quot;</span>&gt;<span class="String">&quot;</span></span> <span class="Keyword">+</span> context.map(<span class="Storage">function</span>(item) {&#x000A;    <span class="Keyword">return</span> <span class="String"><span class="String">&quot;</span>&lt;li&gt;<span class="String">&quot;</span></span> <span class="Keyword">+</span> options.fn(item) <span class="Keyword">+</span> <span class="String"><span class="String">&quot;</span>&lt;/li&gt;<span class="String">&quot;</span></span>;&#x000A;  }).<span class="SupportFunction">join</span>(<span class="String"><span class="String">&quot;</span><span class="StringConstant">\n</span><span class="String">&quot;</span></span>) <span class="Keyword">+</span> <span class="String"><span class="String">&quot;</span>&lt;/ul&gt;<span class="String">&quot;</span></span>;&#x000A;});&#x000A;</pre>
            <div class="notes">
              哈希参数提供了一个强大的方法来给 helper 提供任意数量的可选参数，而且避免了由可选性导致的复杂语法。
            </div>
          </div>
        </div>
        <div class="contents">
          <div class="bullet">
            <div class="description">
              <p>
                块级helper还可以往它的子模板中注入私有变量。在一些情况下会很有帮助，比如需要把一些不在原来上下文中的数据插进来。
              </p>
              <p>
                例如，在循环一个列表的时候，你需要以私有变量的形式提供当前的索引index值。
              </p>
            </div>
            <pre class="sunburst"><span class="EmbeddedSourceBright">{{#list array}}</span>&#x000A;  <span class="EmbeddedSourceBright">{{@index}}</span>. <span class="EmbeddedSourceBright">{{title}}</span>&#x000A;<span class="EmbeddedSourceBright">{{/list}}</span>&#x000A;</pre>
            <pre class="sunburst">Handlebars.registerHelper(<span class="String"><span class="String">&#39;</span>list<span class="String">&#39;</span></span>, <span class="Storage">function</span>(context, options) {&#x000A;  <span class="Storage">var</span> out <span class="Keyword">=</span> <span class="String"><span class="String">&quot;</span>&lt;ul&gt;<span class="String">&quot;</span></span>, data;&#x000A;&#x000A;  <span class="Keyword">if</span> (options.<span class="SupportConstant">data</span>) {&#x000A;    data <span class="Keyword">=</span> Handlebars.createFrame(options.<span class="SupportConstant">data</span>);&#x000A;  }&#x000A;&#x000A;  <span class="Keyword">for</span> (<span class="Storage">var</span> i<span class="Keyword">=</span><span class="Constant">0</span>; i<span class="Keyword">&lt;</span>context.<span class="SupportConstant">length</span>; i<span class="Keyword">++</span>) {&#x000A;    <span class="Keyword">if</span> (data) {&#x000A;      data.<span class="SupportConstant">index</span> <span class="Keyword">=</span> i;&#x000A;    }&#x000A;&#x000A;    out <span class="Keyword">+</span><span class="Keyword">=</span> <span class="String"><span class="String">&quot;</span>&lt;li&gt;<span class="String">&quot;</span></span> <span class="Keyword">+</span> options.fn(context[i], { data: data }) <span class="Keyword">+</span> <span class="String"><span class="String">&quot;</span>&lt;/li&gt;<span class="String">&quot;</span></span>;&#x000A;  }&#x000A;&#x000A;  out <span class="Keyword">+</span><span class="Keyword">=</span> <span class="String"><span class="String">&quot;</span>&lt;/ul&gt;<span class="String">&quot;</span></span>;&#x000A;  <span class="Keyword">return</span> out;&#x000A;});&#x000A;</pre>
            <div class="notes">
              私有属性通过 <code>data</code> 选项来提供，并且在所有的内部作用域内都可以使用。
            </div>
            <div class="notes">
              要保证每次带着 data 执行代码块的时候都生成一个新的 data 帧。否则的话，后面的 helpers 可能会意外的改变前面的变量。
            </div>
            <div class="notes">
              还要确保在试图跟已存在的 data 对象交互之前 data 对象已经存在了。
              私有变量的行为是有条件编译的，有一些模板可能并没有创建这个字段
            </div>
            <div class="notes">
              Also ensure that the <code>data</code> field is defined prior to attempting to
              interact with an existing data object. The private variable behavior is condtionally
              compiled and some templates might not create this field.
            </div>
          </div>
        </div>
        <h2 id="block-params">
          Block Parameters
        </h2>
        <div class="contents">
          <div class="bullet">
            <div class="description">
              New in Handlebars 3.0, it's possible to receive named parameters from supporting helpers.
            </div>
            <pre class="sunburst"><span class="EmbeddedSourceBright">{{#each users as |user userId|}}</span>&#x000A;  Id: <span class="EmbeddedSourceBright">{{userId}}</span> Name: <span class="EmbeddedSourceBright">{{user.name}}</span>&#x000A;<span class="EmbeddedSourceBright">{{/each}}</span>&#x000A;</pre>
            <div class="notes">
              In this particular example, <code>user</code> will have the same value as the current context and <code>userId</code> will have the index value for the iteration.
            </div>
            <div class="notes">
              This allows for nested helpers to avoid name conflicts that can occur with private variables.
            </div>
            <pre class="sunburst"><span class="EmbeddedSourceBright">{{#each users as |user userId|}}</span>&#x000A;  <span class="EmbeddedSourceBright">{{#each user.book as |book bookId|}}</span>&#x000A;    User Id: <span class="EmbeddedSourceBright">{{userId}}</span> Book Id: <span class="EmbeddedSourceBright">{{bookId}}</span>&#x000A;  <span class="EmbeddedSourceBright">{{/each}}</span>&#x000A;<span class="EmbeddedSourceBright">{{/each}}</span>&#x000A;</pre>
          </div>
          <div class="bullet">
            <div class="description">
              A number of <a href="builtin_helpers.html">builtin helpers</a> support block parameters and any custom helper may provide them through the <code>blockParams</code> options field.
            </div>
            <pre class="sunburst">Handlebars.registerHelper(<span class="String"><span class="String">&#39;</span>block-params<span class="String">&#39;</span></span>, <span class="Storage">function</span>() {&#x000A;  <span class="Storage">var</span> args <span class="Keyword">=</span> [],&#x000A;      options <span class="Keyword">=</span> arguments[arguments.<span class="SupportConstant">length</span> <span class="Keyword">-</span> <span class="Constant">1</span>];&#x000A;  <span class="Keyword">for</span> (<span class="Storage">var</span> i <span class="Keyword">=</span> <span class="Constant">0</span>; i <span class="Keyword">&lt;</span> arguments.<span class="SupportConstant">length</span> <span class="Keyword">-</span> <span class="Constant">1</span>; i<span class="Keyword">++</span>) {&#x000A;    args.<span class="SupportFunction">push</span>(arguments[i]);&#x000A;  }&#x000A;&#x000A;  <span class="Keyword">return</span> options.fn(<span class="Variable">this</span>, {data: options.<span class="SupportConstant">data</span>, blockParams: args});&#x000A;});&#x000A;</pre>
            <pre class="sunburst"><span class="EmbeddedSourceBright">{{#block-params 1 2 3 as |foo bar baz|}}</span>&#x000A;  <span class="EmbeddedSourceBright">{{foo}}</span> <span class="EmbeddedSourceBright">{{bar}}</span> <span class="EmbeddedSourceBright">{{baz}}</span>&#x000A;<span class="EmbeddedSourceBright">{{/block-params}}</span>&#x000A;</pre>
            <div class="notes">
              Implements a helper that allows for named variable declarations within a given block. This example would output <code>1 2 3</code> on render.
            </div>
            <div class="notes">
              Helpers can determine the number of block paramemters referenced by the template via the <code>options.fn.blockParams</code> field, which is an integer count. This value represents the number of block parameters that could be referenced by the child template. Parameters beyond this cound will never be referenced and can safely be omitted by the helper if desired. This is optional and any additional parameters passed to the template will be silently ignored.
            </div>
          </div>
        </div>
        <h2 id="raw-blocks">
          Raw Blocks
        </h2>
        <div class="contents">
          <div class="bullet">
            <div class="description">
              Raw blocks are available for templates needing to handle unprocessed mustache blocks.
              <pre class="sunburst"><span class="EmbeddedSourceBright">{{{{raw-helper}}</span>}}&#x000A;  <span class="EmbeddedSourceBright">{{bar}}</span>&#x000A;<span class="EmbeddedSourceBright">{{{{/raw-helper}}</span>}}&#x000A;</pre>
              <div class="notes">
                will execute the helper <code>raw-helper</code> without interpretting the content.
              </div>
              <pre class="sunburst">Handlebars.registerHelper(<span class="String"><span class="String">&#39;</span>raw-helper<span class="String">&#39;</span></span>, <span class="Storage">function</span>(options) {&#x000A;  <span class="Keyword">return</span> options.fn();&#x000A;});&#x000A;</pre>
              <div class="notes">
                will render
              </div>
              <pre class="sunburst"><span class="EmbeddedSourceBright">{{bar}}</span>&#x000A;</pre>
            </div>
          </div>
        </div>
        <a class="issue-tracker" href="https://github.com/wycats/handlebars-site/issues">
          如果发现问题？ 告诉我们！
        </a>
      </div>
    </div>
    <div id="credits"></div>
    <a href="http://github.com/wycats/handlebars.js/" id="github">
      <img alt="Fork me on GitHub" src="http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png">
    </a>
    <script>
      var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1256697465'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s11.cnzz.com/stat.php%3Fid%3D1256697465' type='text/javascript'%3E%3C/script%3E"));
    </script>
  </body>
</html>
